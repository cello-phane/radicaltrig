<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RAU Reflective Rotation Demo</title>
<style>
  body {
    background: #fff;
    font-family: monospace;
    text-align: center;
    margin: 0;
    padding: 1rem;
  }
  h2 { margin: 0.4rem 0; }
  canvas {
    border: 1px solid #ccc;
    border-radius: 8px;
    background: #fff;
  }
  .controls { margin-top: 1rem; }
</style>
</head>
<body>

<h1>Reflective Rotation (RAU Frame Bending)</h1>
<canvas id="rauCanvas" width="400" height="400"></canvas>
<div class="controls">
  <label>Phase (0â€“4): 
    <input type="range" id="phaseSlider" min="0" max="4" step="0.001" value="0">
  </label>
  <label><input type="checkbox" id="autoCheck"> Auto</label>
</div>

<script>
const canvas = document.getElementById('rauCanvas');
const ctx = canvas.getContext('2d');
const slider = document.getElementById('phaseSlider');
const autoCheck = document.getElementById('autoCheck');

let t = 0;
let last = 0;

function radicalSine(t) {
  t = t % 4;
  const q = Math.floor(t);
  const lt = t - q;
  const a = 1 - 2*lt + 2*lt*lt;
  switch(q){
    case 0: return lt / Math.sqrt(a);
    case 1: return (1 - lt) / Math.sqrt(a);
    case 2: return -lt / Math.sqrt(a);
    case 3: return -(1 - lt) / Math.sqrt(a);
  }
}
function radicalCosine(t) {
  t = t % 4;
  const q = Math.floor(t);
  const lt = t - q;
  const a = 1 - 2*lt + 2*lt*lt;
  switch(q){
    case 0: return (1 - lt) / Math.sqrt(a);
    case 1: return -lt / Math.sqrt(a);
    case 2: return -(1 - lt) / Math.sqrt(a);
    case 3: return lt / Math.sqrt(a);
  }
}

function drawRAUFrame(t) {
  const W = canvas.width, H = canvas.height;
  const cx = W/2, cy = H/2;
  const r = 100;

  ctx.clearRect(0,0,W,H);

  // Draw static reference circle
  ctx.strokeStyle = "#ddd";
  ctx.lineWidth = 1.5;
  ctx.beginPath();
  ctx.arc(cx, cy, r, 0, 2*Math.PI);
  ctx.stroke();

  // Determine frame bending
  const c = radicalCosine(t);
  const s = radicalSine(t);

  // Draw bending coordinate axes
  ctx.strokeStyle = "#888";
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(cx, cy);
  ctx.lineTo(cx + r*c, cy - r*s); // x-axis direction
  ctx.moveTo(cx, cy);
  ctx.lineTo(cx - r*s, cy - r*c); // y-axis direction
  ctx.stroke();

  // Draw point showing "current reflected rotation"
  ctx.fillStyle = "red";
  ctx.beginPath();
  ctx.arc(cx + r*c, cy - r*s, 6, 0, 2*Math.PI);
  ctx.fill();

  // Labels
  ctx.fillStyle = "#222";
  ctx.font = "14px monospace";
  ctx.fillText(`Quadrant: ${Math.floor(t)}`, 20, 25);
  ctx.fillText(`RAU Phase: ${t.toFixed(3)}`, 20, 45);
  ctx.fillText(`cos=${c.toFixed(3)}, sin=${s.toFixed(3)}`, 20, 65);
}

function animate(timestamp) {
  if (last === 0) last = timestamp;
  const dt = (timestamp - last)/1000;
  last = timestamp;

  if (autoCheck.checked) {
    t += dt * 0.5; // speed factor
    if (t > 4.0) t = 0;
    slider.value = t;
  }
  drawRAUFrame(t);
  requestAnimationFrame(animate);
}

slider.addEventListener('input', () => {
  t = parseFloat(slider.value);
  drawRAUFrame(t);
});

drawRAUFrame(0);
requestAnimationFrame(animate);
</script>

</body>
</html>
