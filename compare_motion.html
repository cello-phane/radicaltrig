<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Radian vs RAU Rotation Demo</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #fff;
        color: #222;
        text-align: center;
        margin: 0;
        padding: 20px;
    }
    h2 {
        margin: 8px 0;
    }
    .container {
        display: flex;
        justify-content: center;
        gap: 40px;
        margin-top: 20px;
    }
    canvas {
        border: 1px solid #ccc;
        border-radius: 8px;
        background: #fff;
    }
    .controls {
        margin-top: 20px;
    }
    .controls label {
        margin: 0 10px;
    }
</style>
</head>
<body>

<h1>Uniform (Radian) vs Non-Uniform (RAU) Rotation</h1>
<div class="container">
    <div>
        <h2>Radian</h2>
        <canvas id="radianCanvas" width="300" height="300"></canvas>
    </div>
    <div>
        <h2>RAU</h2>
        <canvas id="rauCanvas" width="300" height="300"></canvas>
    </div>
</div>

<div class="controls">
    <label>Phase:
        <input type="range" id="phaseSlider" min="0" max="1" step="0.001" value="0">
    </label>
    <label><input type="checkbox" id="autoCheck"> Auto Rotate</label>
    <label>Speed:
        <input type="range" id="speedSlider" min="0.1" max="2" step="0.1" value="1">
    </label>
    <label><input type="checkbox" id="labelCheck" checked> Show Labels</label>
</div>

<script>
const radianCanvas = document.getElementById("radianCanvas");
const rauCanvas = document.getElementById("rauCanvas");
const rctx = radianCanvas.getContext("2d");
const ractx = rauCanvas.getContext("2d");
const slider = document.getElementById("phaseSlider");
const autoCheck = document.getElementById("autoCheck");
const speedSlider = document.getElementById("speedSlider");
const labelCheck = document.getElementById("labelCheck");

let t = 0;
let lastTime = 0;

function drawCircle(ctx, label, theta, showLabels) {
    const W = ctx.canvas.width;
    const H = ctx.canvas.height;
    const cx = W / 2;
    const cy = H / 2;
    const radius = 100;

    ctx.clearRect(0, 0, W, H);

    // grid lines
    ctx.strokeStyle = "#eee";
    for (let i = -2; i <= 2; i++) {
        ctx.beginPath();
        ctx.moveTo(0, cy + i * 50);
        ctx.lineTo(W, cy + i * 50);
        ctx.moveTo(cx + i * 50, 0);
        ctx.lineTo(cx + i * 50, H);
        ctx.stroke();
    }

    // circle
    ctx.strokeStyle = "#555";
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.arc(cx, cy, radius, 0, 2 * Math.PI);
    ctx.stroke();

    // marker dot
    const x = cx - radius * Math.cos(theta);
    const y = cy - radius * Math.sin(theta);
    ctx.fillStyle = "red";
    ctx.beginPath();
    ctx.arc(x, y, 6, 0, 2 * Math.PI);
    ctx.fill();

    // labels if enabled
    if (showLabels) {
        ctx.fillStyle = "#000";
        ctx.font = "12px monospace";
        const keyAngles = [270, 180, 150, 120, 90, 60, 45, 30, 0];
        keyAngles.forEach(a => {
            const rad = -(a * Math.PI / 180);
            const lx = cx + (radius + 18) * Math.cos(rad);
            const ly = cy + (radius + 18) * Math.sin(rad);
            ctx.fillText(a.toString(), lx - 10, ly + 4);
        });
    }

    // snapping highlight
    //const deg = (theta * 180 / Math.PI + 360) % 360;
    //const snapAngles = [0, 30, 45, 60, 90, 120, 150, 180, 270];
    //const near = snapAngles.find(a => Math.abs(deg - a) < 1);
    //if (near !== undefined) {
    //    ctx.fillStyle = "#000";
    //    ctx.font = "bold 14px monospace";
    //    ctx.fillText(near + "°", cx - 15, 25);
    //}
}

// RAU → radian mapping
function rauToTheta(t) {
    return -(t * (Math.PI / 2));
}

function render() {
    const thetaRad = -(t * 2 * Math.PI)+Math.PI;     // uniform
    const thetaRau = rauToTheta(t)+Math.PI;       // nonlinear

    drawCircle(rctx, "Radian", thetaRad, labelCheck.checked);
    drawCircle(ractx, "RAU", thetaRau, labelCheck.checked);
}

function animate(timestamp) {
    if (lastTime === 0) lastTime = timestamp;
    const dt = (timestamp - lastTime) / 1000;
    lastTime = timestamp;

    if (autoCheck.checked) {
        const speed = parseFloat(speedSlider.value);
        t += dt * 0.1 * speed;
        t %= 1;
        slider.value = t;
    }
    render();
    requestAnimationFrame(animate);
}

slider.addEventListener("input", () => {
    t = parseFloat(slider.value);
    render();
});

render();
requestAnimationFrame(animate);
</script>

</body>
</html>
