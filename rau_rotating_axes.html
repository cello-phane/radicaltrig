<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RAU Axis Reflection with Quadrant Labels</title>
<style>
  body {
    background: #fff;
    color: #222;
    text-align: center;
    font-family: monospace;
    margin: 0;
    padding: 10px;
  }
  canvas {
    border: 1px solid #ccc;
    margin-top: 10px;
    border-radius: 8px;
    background: #fff;
  }
  label { margin: 0 8px; }
</style>
</head>
<body>
<h2>RAU Axis Reflection â€” Quadrant Symmetry Mapping</h2>
<canvas id="canvas" width="380" height="380"></canvas>
<br>
<label>Phase:
  <input type="range" id="slider" min="0" max="4" step="0.001" value="0">
</label>
<label><input type="checkbox" id="auto" checked> Auto</label>
<label>Speed:
  <input type="range" id="speed" min="0.1" max="2" step="0.1" value="1">
</label>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const slider = document.getElementById('slider');
const auto = document.getElementById('auto');
const speedSlider = document.getElementById('speed');

let t = 0, lastTime = 0;

function getRAUComponents(f) {
  const a = 1 - 2*f + 2*f*f;
  const denom = 1 / Math.sqrt(a);
  const c = (1 - f) * denom;
  const s = f * denom;
  return { c, s };
}

function getRotationComponents(param) {
  const absVal = Math.abs(param);
  const quadrant = Math.floor(absVal) % 4;
  const fraction = absVal - quadrant;
  const { c, s } = getRAUComponents(fraction);

  let cos = 0, sin = 0;
  if (quadrant === 0) { cos = c; sin = s; }
  if (quadrant === 1) { cos = -s; sin = c; }
  if (quadrant === 2) { cos = -c; sin = -s; }
  if (quadrant === 3) { cos = s; sin = -c; }

  return { cos, sin, quadrant };
}

function drawAxes(param) {
  const W = canvas.width, H = canvas.height;
  const cx = W/2, cy = H/2, radius = 130;

  ctx.clearRect(0, 0, W, H);
  ctx.strokeStyle = "#eee";
  for (let i=-3; i<=3; i++) {
    ctx.beginPath();
    ctx.moveTo(0, cy+i*40);
    ctx.lineTo(W, cy+i*40);
    ctx.moveTo(cx+i*40, 0);
    ctx.lineTo(cx+i*40, H);
    ctx.stroke();
  }

  // Circle outline
  ctx.strokeStyle = "#888";
  ctx.beginPath();
  ctx.arc(cx, cy, radius, 0, Math.PI*2);
  ctx.stroke();

  // Get rotating axes
  const { cos, sin, quadrant } = getRotationComponents(param % 4);

  // X-axis (cos direction)
  ctx.strokeStyle = "#e74c3c";
  ctx.lineWidth = 3;
  ctx.beginPath();
  ctx.moveTo(cx - cos*radius, cy + sin*radius);
  ctx.lineTo(cx + cos*radius, cy - sin*radius);
  ctx.stroke();

  // Y-axis (sin direction)
  ctx.strokeStyle = "#3498db";
  ctx.beginPath();
  ctx.moveTo(cx + sin*radius, cy + cos*radius);
  ctx.lineTo(cx - sin*radius, cy - cos*radius);
  ctx.stroke();

  // Quadrant rule labels
  ctx.fillStyle = "#000";
  ctx.font = "12px monospace";

  const labels = [
    { q: 0, txt: "Q0: cos=+c, sin=+s", x: cx+radius/3, y: cy-radius/2 },
    { q: 1, txt: "Q1: cos=-s, sin=+c", x: cx-radius/1.5, y: cy-radius/2 },
    { q: 2, txt: "Q2: cos=-c, sin=-s", x: cx-radius/1.5, y: cy+radius/2 },
    { q: 3, txt: "Q3: cos=+s, sin=-c", x: cx+radius/3, y: cy+radius/2 },
  ];

  labels.forEach(l => {
    ctx.fillStyle = l.q === quadrant ? "#e74c3c" : "#555";
    ctx.fillText(l.txt, l.x, l.y);
  });

  // Info text
  ctx.fillStyle = "#000";
  ctx.font = "14px monospace";
  ctx.fillText(`RAU param: ${param.toFixed(2)}`, 10, 20);
  ctx.fillText(`Quadrant: ${quadrant}`, 10, 38);
}

function animate(timestamp) {
  if (!lastTime) lastTime = timestamp;
  const dt = (timestamp - lastTime) / 1000;
  lastTime = timestamp;

  if (auto.checked) {
    const speed = parseFloat(speedSlider.value);
    t = (t + dt * 0.5 * speed) % 4;
    slider.value = t;
  }

  drawAxes(t);
  requestAnimationFrame(animate);
}

slider.addEventListener('input', () => {
  t = parseFloat(slider.value);
  drawAxes(t);
});

drawAxes(t);
requestAnimationFrame(animate);
</script>
</body>
</html>
